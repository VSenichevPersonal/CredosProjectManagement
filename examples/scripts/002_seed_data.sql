-- IB Compliance Platform - Seed Data
-- Version: 1.0.0
-- Description: Initial seed data for testing

-- Insert root organization (Министерство)
INSERT INTO organizations (id, name, type, level, inn, ogrn, industry, employee_count, has_kii, has_pdn)
VALUES 
  ('00000000-0000-0000-0000-000000000001', 'Министерство цифрового развития', 'ministry', 1, '7710000001', '1027700000001', 'Государственное управление', 500, true, true);

-- Insert child organizations (Учреждения)
INSERT INTO organizations (id, name, type, level, parent_id, inn, ogrn, industry, employee_count, has_kii, has_pdn)
VALUES 
  ('00000000-0000-0000-0000-000000000002', 'ФГБУ "Центр информационных технологий"', 'institution', 2, '00000000-0000-0000-0000-000000000001', '7710000002', '1027700000002', 'Информационные технологии', 150, true, true),
  ('00000000-0000-0000-0000-000000000003', 'ФГБУ "Научно-исследовательский институт"', 'institution', 2, '00000000-0000-0000-0000-000000000001', '7710000003', '1027700000003', 'Научные исследования', 200, false, true);

-- Insert branches (Филиалы)
INSERT INTO organizations (id, name, type, level, parent_id, inn, employee_count)
VALUES 
  ('00000000-0000-0000-0000-000000000004', 'Московский филиал ЦИТ', 'branch', 3, '00000000-0000-0000-0000-000000000002', '7710000002', 50),
  ('00000000-0000-0000-0000-000000000005', 'Санкт-Петербургский филиал ЦИТ', 'branch', 3, '00000000-0000-0000-0000-000000000002', '7710000002', 40);

-- Insert test users (passwords should be hashed in production)
INSERT INTO users (id, email, name, role, organization_id, is_active)
VALUES 
  ('10000000-0000-0000-0000-000000000001', 'admin@system.ru', 'Системный администратор', 'super_admin', NULL, true),
  ('10000000-0000-0000-0000-000000000002', 'regulator@fstek.ru', 'Инспектор ФСТЭК', 'regulator_admin', NULL, true),
  ('10000000-0000-0000-0000-000000000003', 'ministry@mindigital.ru', 'Сотрудник министерства', 'ministry_user', '00000000-0000-0000-0000-000000000001', true),
  ('10000000-0000-0000-0000-000000000004', 'ciso@cit.ru', 'CISO ЦИТ', 'ciso', '00000000-0000-0000-0000-000000000002', true),
  ('10000000-0000-0000-0000-000000000005', 'user@cit.ru', 'Специалист ЦИТ', 'institution_user', '00000000-0000-0000-0000-000000000002', true);

-- Insert sample requirements
INSERT INTO requirements (id, code, title, description, regulator, normative_base, category, criticality, deadline, periodicity, verification_method, responsible_role, created_by)
VALUES 
  (
    '20000000-0000-0000-0000-000000000001',
    'КИИ-2025-001',
    'Категорирование объектов КИИ',
    'Проведение категорирования объектов критической информационной инфраструктуры в соответствии с требованиями 187-ФЗ',
    'ФСТЭК',
    ARRAY['187-ФЗ', 'Приказ ФСТЭК №239'],
    'КИИ',
    'critical',
    '2025-12-31 23:59:59',
    'annual',
    'document',
    'CISO',
    '10000000-0000-0000-0000-000000000002'
  ),
  (
    '20000000-0000-0000-0000-000000000002',
    'ПДН-2025-001',
    'Уведомление об обработке персональных данных',
    'Подача уведомления в Роскомнадзор об обработке персональных данных',
    'Роскомнадзор',
    ARRAY['152-ФЗ', 'Постановление Правительства №1119'],
    'ПДн',
    'high',
    '2025-06-30 23:59:59',
    'once',
    'document',
    'CISO',
    '10000000-0000-0000-0000-000000000002'
  ),
  (
    '20000000-0000-0000-0000-000000000003',
    'КИИ-2025-002',
    'Аттестация объектов КИИ',
    'Проведение аттестации объектов КИИ по требованиям безопасности информации',
    'ФСТЭК',
    ARRAY['187-ФЗ', 'Приказ ФСТЭК №235'],
    'КИИ',
    'critical',
    '2025-09-30 23:59:59',
    'annual',
    'document',
    'CISO',
    '10000000-0000-0000-0000-000000000002'
  ),
  (
    '20000000-0000-0000-0000-000000000004',
    'ИБ-2025-001',
    'Разработка политики информационной безопасности',
    'Разработка и утверждение политики информационной безопасности организации',
    'ФСТЭК',
    ARRAY['Приказ ФСТЭК №21'],
    'ИБ',
    'high',
    '2025-03-31 23:59:59',
    'annual',
    'document',
    'CISO',
    '10000000-0000-0000-0000-000000000002'
  ),
  (
    '20000000-0000-0000-0000-000000000005',
    'ПДН-2025-002',
    'Оценка вреда субъектам ПДн',
    'Проведение оценки вреда, который может быть причинен субъектам персональных данных',
    'Роскомнадзор',
    ARRAY['152-ФЗ', 'Постановление Правительства №1119'],
    'ПДн',
    'medium',
    '2025-12-31 23:59:59',
    'annual',
    'document',
    'CISO',
    '10000000-0000-0000-0000-000000000002'
  );

-- Insert compliance records for organizations
INSERT INTO compliance (requirement_id, organization_id, status, progress_percentage, responsible_user_id, planned_completion_date)
VALUES 
  ('20000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000002', 'in_progress', 45, '10000000-0000-0000-0000-000000000004', '2025-11-30 23:59:59'),
  ('20000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000002', 'completed', 100, '10000000-0000-0000-0000-000000000004', '2025-05-15 23:59:59'),
  ('20000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000002', 'not_started', 0, '10000000-0000-0000-0000-000000000004', '2025-08-31 23:59:59'),
  ('20000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000002', 'in_progress', 70, '10000000-0000-0000-0000-000000000004', '2025-03-15 23:59:59'),
  ('20000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000003', 'not_applicable', 0, NULL, NULL);

-- Insert sample notifications
INSERT INTO notifications (user_id, type, title, message, is_read, related_resource_type, related_resource_id)
VALUES 
  ('10000000-0000-0000-0000-000000000004', 'deadline_reminder', 'Приближается дедлайн', 'До завершения требования "Категорирование объектов КИИ" осталось 30 дней', false, 'requirement', '20000000-0000-0000-0000-000000000001'),
  ('10000000-0000-0000-0000-000000000004', 'new_requirement', 'Новое требование', 'Добавлено новое требование: Разработка политики информационной безопасности', false, 'requirement', '20000000-0000-0000-0000-000000000004'),
  ('10000000-0000-0000-0000-000000000005', 'assignment', 'Назначена задача', 'Вам назначена задача по выполнению требования "Аттестация объектов КИИ"', false, 'compliance', '20000000-0000-0000-0000-000000000003');
