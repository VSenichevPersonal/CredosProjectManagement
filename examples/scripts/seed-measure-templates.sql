-- Seed data for measure templates based on Russian InfoSec compliance requirements
-- FSTEC, FSB, 152-FZ (Personal Data Law), 187-FZ (Security of Critical Infrastructure)

-- Removed category, implementation_guidance, verification_method, frequency, estimated_effort_hours, tenant_id columns
-- Using actual schema: id, code, title, description, implementation_guide, estimated_effort, requirement_id, is_active, sort_order, created_by

-- Category: Access Control (Управление доступом)
INSERT INTO control_measure_templates (id, code, title, description, implementation_guide, estimated_effort, is_active, sort_order, created_by)
VALUES
  (gen_random_uuid(), 'AC-001', 'Настройка парольной политики', 'Установка требований к сложности паролей: минимум 8 символов, использование заглавных и строчных букв, цифр и специальных символов', 'Настроить политику паролей в Active Directory или аналогичной системе управления идентификацией. Установить минимальную длину пароля 8 символов, требовать использование заглавных букв, строчных букв, цифр и специальных символов. Настроить срок действия пароля 90 дней.', '4 часа', true, 1, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'AC-002', 'Двухфакторная аутентификация', 'Внедрение двухфакторной аутентификации для доступа к критичным системам', 'Развернуть систему двухфакторной аутентификации (2FA) для всех пользователей с доступом к критичным системам. Использовать TOTP (Time-based One-Time Password) или аппаратные токены. Обучить пользователей работе с 2FA.', '16 часов', true, 2, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'AC-003', 'Разграничение прав доступа', 'Реализация принципа минимальных привилегий для всех учетных записей', 'Провести аудит текущих прав доступа. Применить принцип минимальных привилегий: каждый пользователь должен иметь только те права, которые необходимы для выполнения его должностных обязанностей. Документировать матрицу доступа.', '12 часов', true, 3, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'AC-004', 'Блокировка неактивных учетных записей', 'Автоматическая блокировка учетных записей после 90 дней неактивности', 'Настроить автоматическую блокировку учетных записей, которые не использовались в течение 90 дней. Создать процедуру ежемесячной проверки и удаления неактивных учетных записей. Вести журнал заблокированных учетных записей.', '8 часов', true, 4, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1));

-- Category: Network Security (Сетевая безопасность)
INSERT INTO control_measure_templates (id, code, title, description, implementation_guide, estimated_effort, is_active, sort_order, created_by)
VALUES
  (gen_random_uuid(), 'NS-001', 'Настройка межсетевого экрана', 'Конфигурация правил firewall для защиты периметра сети', 'Настроить правила межсетевого экрана (firewall) для блокировки нежелательного трафика. Разрешить только необходимые порты и протоколы. Реализовать правило "запретить все, разрешить необходимое". Документировать все правила.', '20 часов', true, 5, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'NS-002', 'Сегментация сети', 'Разделение сети на сегменты для изоляции критичных систем', 'Разделить сеть на сегменты (VLAN) для изоляции критичных систем от общей корпоративной сети. Создать отдельные сегменты для серверов, рабочих станций, гостевой сети. Настроить межсегментные правила доступа.', '40 часов', true, 6, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'NS-003', 'Мониторинг сетевого трафика', 'Внедрение системы мониторинга и анализа сетевого трафика', 'Развернуть систему мониторинга сетевого трафика (IDS/IPS). Настроить правила обнаружения аномалий и атак. Настроить оповещения о подозрительной активности. Проводить еженедельный анализ логов.', '24 часа', true, 7, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'NS-004', 'VPN для удаленного доступа', 'Настройка защищенного VPN-соединения для удаленных сотрудников', 'Развернуть VPN-сервер для обеспечения защищенного удаленного доступа. Использовать современные протоколы шифрования (IPSec, OpenVPN). Требовать использование VPN для всех удаленных подключений. Вести журнал VPN-подключений.', '16 часов', true, 8, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1));

-- Category: Data Protection (Защита данных)
INSERT INTO control_measure_templates (id, code, title, description, implementation_guide, estimated_effort, is_active, sort_order, created_by)
VALUES
  (gen_random_uuid(), 'DP-001', 'Шифрование персональных данных', 'Шифрование персональных данных в базах данных и при передаче', 'Внедрить шифрование персональных данных в базах данных (encryption at rest) и при передаче по сети (encryption in transit). Использовать алгоритмы шифрования, соответствующие требованиям ФСТЭК (ГОСТ 28147-89, ГОСТ Р 34.11-2012). Управлять ключами шифрования.', '32 часа', true, 9, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'DP-002', 'Резервное копирование', 'Регулярное резервное копирование критичных данных', 'Настроить автоматическое ежедневное резервное копирование критичных данных. Хранить резервные копии в отдельном защищенном месте. Проводить ежемесячное тестирование восстановления данных из резервных копий. Документировать процедуру восстановления.', '12 часов', true, 10, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'DP-003', 'Классификация данных', 'Классификация данных по уровням конфиденциальности', 'Разработать политику классификации данных. Определить уровни конфиденциальности (публичные, внутренние, конфиденциальные, строго конфиденциальные). Провести инвентаризацию и классификацию всех данных. Применить соответствующие меры защиты для каждого уровня.', '40 часов', true, 11, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'DP-004', 'DLP система', 'Внедрение системы предотвращения утечек данных (DLP)', 'Развернуть систему DLP для мониторинга и предотвращения утечек конфиденциальных данных. Настроить правила обнаружения персональных данных, коммерческой тайны. Настроить блокировку передачи данных через USB, email, облачные хранилища. Проводить еженедельный анализ инцидентов.', '48 часов', true, 12, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1));

-- Category: Vulnerability Management (Управление уязвимостями)
INSERT INTO control_measure_templates (id, code, title, description, implementation_guide, estimated_effort, is_active, sort_order, created_by)
VALUES
  (gen_random_uuid(), 'VM-001', 'Сканирование уязвимостей', 'Регулярное сканирование систем на наличие уязвимостей', 'Развернуть систему сканирования уязвимостей (Nessus, OpenVAS). Проводить ежемесячное сканирование всех систем. Классифицировать обнаруженные уязвимости по критичности. Устранять критичные уязвимости в течение 7 дней, высокие - в течение 30 дней.', '16 часов', true, 13, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'VM-002', 'Управление обновлениями', 'Своевременная установка обновлений безопасности', 'Настроить автоматическую установку критичных обновлений безопасности. Создать процедуру тестирования обновлений перед установкой в продуктивной среде. Вести журнал установленных обновлений. Проверять наличие обновлений еженедельно.', '8 часов', true, 14, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'VM-003', 'Пентест', 'Ежегодное тестирование на проникновение', 'Проводить ежегодное тестирование на проникновение (penetration testing) силами внешних специалистов. Тестировать веб-приложения, сетевую инфраструктуру, беспроводные сети. Устранять обнаруженные уязвимости в соответствии с их критичностью. Документировать результаты.', '80 часов', true, 15, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1));

-- Category: Incident Response (Реагирование на инциденты)
INSERT INTO control_measure_templates (id, code, title, description, implementation_guide, estimated_effort, is_active, sort_order, created_by)
VALUES
  (gen_random_uuid(), 'IR-001', 'План реагирования на инциденты', 'Разработка и поддержание плана реагирования на инциденты ИБ', 'Разработать план реагирования на инциденты информационной безопасности. Определить роли и ответственность. Описать процедуры обнаружения, анализа, сдерживания, устранения и восстановления. Проводить ежегодное тестирование плана (tabletop exercise).', '40 часов', true, 16, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'IR-002', 'Журналирование событий', 'Централизованное журналирование событий безопасности', 'Настроить централизованное журналирование событий безопасности (SIEM). Собирать логи с серверов, сетевого оборудования, систем безопасности. Хранить логи не менее 6 месяцев. Настроить оповещения о критичных событиях. Проводить еженедельный анализ логов.', '24 часа', true, 17, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'IR-003', 'Антивирусная защита', 'Установка и обновление антивирусного ПО на всех рабочих станциях', 'Установить антивирусное ПО на все рабочие станции и серверы. Настроить автоматическое обновление антивирусных баз. Проводить еженедельное полное сканирование систем. Настроить централизованное управление и мониторинг антивирусной защиты.', '8 часов', true, 18, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1));

-- Category: Compliance and Audit (Соответствие и аудит)
INSERT INTO control_measure_templates (id, code, title, description, implementation_guide, estimated_effort, is_active, sort_order, created_by)
VALUES
  (gen_random_uuid(), 'CA-001', 'Политики информационной безопасности', 'Разработка и утверждение политик ИБ', 'Разработать комплект политик информационной безопасности: политика ИБ, политика управления доступом, политика использования паролей, политика резервного копирования, политика реагирования на инциденты. Утвердить политики руководством. Ознакомить всех сотрудников.', '60 часов', true, 19, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'CA-002', 'Обучение сотрудников', 'Регулярное обучение сотрудников основам информационной безопасности', 'Проводить ежегодное обучение всех сотрудников основам информационной безопасности. Темы: фишинг, социальная инженерия, безопасность паролей, работа с конфиденциальными данными. Проводить тестирование после обучения. Документировать прохождение обучения.', '24 часа', true, 20, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'CA-003', 'Внутренний аудит ИБ', 'Проведение внутреннего аудита соответствия требованиям ИБ', 'Проводить ежегодный внутренний аудит соответствия требованиям информационной безопасности. Проверять выполнение политик и процедур ИБ. Выявлять несоответствия и разрабатывать план корректирующих действий. Документировать результаты аудита.', '40 часов', true, 21, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1)),
  
  (gen_random_uuid(), 'CA-004', 'Инвентаризация активов', 'Ведение реестра информационных активов', 'Создать и поддерживать реестр всех информационных активов: серверы, рабочие станции, сетевое оборудование, программное обеспечение, базы данных. Классифицировать активы по критичности. Назначить владельцев активов. Проводить ежеквартальную актуализацию реестра.', '16 часов', true, 22, (SELECT id FROM users WHERE email = 'admin@mail.ru' LIMIT 1));
