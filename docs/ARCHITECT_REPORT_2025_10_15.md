# üèóÔ∏è –û—Ç—á—ë—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ - 15 –æ–∫—Ç—è–±—Ä—è 2025

## üìä –°–≤–æ–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç

**–î–∞—Ç–∞**: 2025-10-15  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä**: AI Senior Architect

---

## üéØ –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚ùå –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∞–≤ (–ö–†–ò–¢–ò–ß–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞**:
```
Error: Access denied: missing permission 'time:read'
```

**–ü—Ä–∏—á–∏–Ω–∞**: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –ø—Ä–∞–≤ –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö:
- `src/lib/context/execution-context.ts` - –æ–ø—Ä–µ–¥–µ–ª—è–ª–æ `time:read`, `time:create`, etc.
- `src/lib/access-control/permissions.ts` - –æ–ø—Ä–µ–¥–µ–ª—è–ª–æ `time_entries:read`, `time_entries:create`, etc.

–°–µ—Ä–≤–∏—Å—ã –ø—Ä–æ–≤–µ—Ä—è–ª–∏ `time:read`, –∞ —Å–∏—Å—Ç–µ–º–∞ –¥–∞–≤–∞–ª–∞ `time_entries:read` ‚Üí –ø—Ä–∞–≤–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª–∏.

**–†–µ—à–µ–Ω–∏–µ**:
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã –∏–∑ `execution-context.ts`
- ‚úÖ –û—Å—Ç–∞–≤–ª–µ–Ω –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã: `permissions.ts`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã: `TimeEntryService`, `TimeTrackingService`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `ExecutionContext` –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ç–∏–ø–æ–≤ –∏–∑ `permissions.ts`

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞, –æ—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞.

---

### 2. üîê –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–æ–ª—è–º–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ù–µ—Ç UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏
- –ù–µ—Ç UI –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è/–æ—Ç–∑—ã–≤–∞ —Ä–æ–ª–µ–π
- –ù–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–∞—Ç—Ä–∏—Ü—ã –ø—Ä–∞–≤
- –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SQL

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

#### üì° API Endpoints (7 –Ω–æ–≤—ã—Ö):

1. **`GET /api/employees/[id]`** - –ø–æ–ª—É—á–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
2. **`PUT /api/employees/[id]`** - –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
3. **`DELETE /api/employees/[id]`** - —É–¥–∞–ª–∏—Ç—å (soft delete)
4. **`GET /api/employees/[id]/roles`** - –ø–æ–ª—É—á–∏—Ç—å —Ä–æ–ª–∏
5. **`POST /api/employees/[id]/roles`** - –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª—å
6. **`DELETE /api/employees/[id]/roles?role=X`** - –æ—Ç–æ–∑–≤–∞—Ç—å —Ä–æ–ª—å
7. **`GET /api/admin/permissions`** - –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤

#### üé® UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (2 –Ω–æ–≤—ã—Ö):

1. **`/admin/users`** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:
   - –ü–æ–∏—Å–∫ –ø–æ –§–ò–û, email, –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
   - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ (Create, Read, Update, Delete)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ (–Ω–∞–∑–Ω–∞—á–∏—Ç—å/–æ—Ç–æ–∑–≤–∞—Ç—å)
   - –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
   
2. **`/admin/permissions`** - –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤:
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö 4 —Ä–æ–ª–µ–π
   - 7 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–∞–≤ (–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, –ü—Ä–æ–µ–∫—Ç—ã, –ó–∞–¥–∞—á–∏, –£—á—ë—Ç –≤—Ä–µ–º–µ–Ω–∏, –û—Ç—á—ë—Ç—ã, –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏)
   - –ü–æ–∏—Å–∫ –ø–æ –ø—Ä–∞–≤–∞–º
   - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å ‚úÖ/‚≠ï

#### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è
- ‚úÖ –ù–µ–ª—å–∑—è –æ—Ç–æ–∑–≤–∞—Ç—å admin —Ä–æ–ª—å —É —Å–∞–º–æ–≥–æ —Å–µ–±—è
- ‚úÖ –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è (granted_by, granted_at)
- ‚úÖ Soft delete –≤–º–µ—Å—Ç–æ hard delete

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

---

### 3. üìö –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ `time_entries`, foreign keys, constraints, –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª.

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã (2 –Ω–æ–≤—ã—Ö):

1. **`TIME_ENTRIES_DATA_INTEGRITY_MODEL.md`** (4,200+ —Å–ª–æ–≤):
   - –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã time_entries
   - 5 Foreign Keys —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
   - 3 Constraints —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π
   - Workflow (draft ‚Üí submitted ‚Üí approved/rejected)
   - –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (read, create, update, delete, approve)
   - –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ (—É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å, –ª–∏–º–∏—Ç—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
   - –¢—Ä–∏–≥–≥–µ—Ä—ã (auto-update updated_at, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

2. **`ADMIN_PANEL_USER_GUIDE.md`** (3,800+ —Å–ª–æ–≤):
   - –û–±–∑–æ—Ä –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ (–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ/–æ—Ç–∑—ã–≤)
   - –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤ (–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–î (–ø—Ä–æ–≤–µ—Ä–∫–∞, –∑–∞—Å–µ–≤, –æ—á–∏—Å—Ç–∫–∞)
   - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
   - API endpoints
   - Troubleshooting (—Ä–µ—à–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

---

## üõ†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 4. üîß –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

–°–æ–∑–¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏:

1. **`scripts/create-auth-for-employees.js`** (–Ω–æ–≤—ã–π):
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç employees –±–µ–∑ auth.user
   - –°–æ–∑–¥–∞—ë—Ç auth.user —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç bcrypt —Ö–µ—à –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: `node scripts/create-auth-for-employees.js`

2. **`scripts/check-and-fix-roles.js`** (–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π):
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤—è–∑—å —Å auth.user
   - –í—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç

3. **`scripts/check-db-integrity.js`** (–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π):
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Foreign Keys (orphaned records)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
   - –í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á, —É–ø—Ä–æ—â–µ–Ω–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
‚úì node scripts/check-and-fix-roles.js
  - admin@mail.ru (admin) ‚úì –°–≤—è–∑–∞–Ω —Å auth.user
  - ivanov@credos.ru (manager) ‚úì –°–≤—è–∑–∞–Ω —Å auth.user
  - petrov@credos.ru (employee) ‚úì –°–≤—è–∑–∞–Ω —Å auth.user
  - sidorov@credos.ru (employee) ‚úì –°–≤—è–∑–∞–Ω —Å auth.user

‚úì node scripts/create-auth-for-employees.js
  - –°–æ–∑–¥–∞–Ω–æ 3 auth.user –∑–∞–ø–∏—Å–∏
  - –í—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å: password123

‚úì node scripts/check-db-integrity.js
  - 15 –∑–∞–ø–∏—Å–µ–π –≤ –ë–î
  - 8 —Ç–∞–±–ª–∏—Ü –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
  - 51 –∏–Ω–¥–µ–∫—Å –Ω–∞–π–¥–µ–Ω
  - ‚úÖ –í—Å–µ foreign keys –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
  - ‚ö†Ô∏è  2 —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —ç—Ç–∞–ø–∞)
```

---

## üì¶ Deployment –Ω–∞ Railway

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã –Ω–∞ production:

**–ö–æ–º–º–∏—Ç—ã**:
1. `26abed65` - fix: —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª —Å–∏—Å—Ç–µ–º—É –ø—Ä–∞–≤ (permissions.ts)
2. `ac98fcca` - feat: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Ä–æ–ª—è–º–∏ –∏ –ø—Ä–∞–≤–∞–º–∏
3. `e32bfdaf` - feat: –¥–æ–±–∞–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è auth.user –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ Railway

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- –û—à–∏–±–∫–∞ `Access denied: missing permission 'time:read'` –∏—Å—á–µ–∑–Ω–µ—Ç
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:
  - `/admin/users` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
  - `/admin/permissions` - –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ**: 13
**–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ**: 10
**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ**: ~2,500
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ**: ~8,000 —Å–ª–æ–≤

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
```
docs/
  ‚îú‚îÄ‚îÄ TIME_ENTRIES_DATA_INTEGRITY_MODEL.md
  ‚îú‚îÄ‚îÄ ADMIN_PANEL_USER_GUIDE.md
  ‚îî‚îÄ‚îÄ ARCHITECT_REPORT_2025_10_15.md (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

src/app/(dashboard)/admin/
  ‚îú‚îÄ‚îÄ users/page.tsx
  ‚îî‚îÄ‚îÄ permissions/page.tsx

src/app/api/
  ‚îú‚îÄ‚îÄ employees/[id]/route.ts
  ‚îú‚îÄ‚îÄ employees/[id]/roles/route.ts
  ‚îî‚îÄ‚îÄ admin/permissions/route.ts

src/components/admin/
  ‚îú‚îÄ‚îÄ user-management-panel.tsx
  ‚îî‚îÄ‚îÄ permissions-matrix-panel.tsx

scripts/
  ‚îî‚îÄ‚îÄ create-auth-for-employees.js
```

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
src/lib/context/
  ‚îú‚îÄ‚îÄ execution-context.ts (—É–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–∞–≤)
  ‚îî‚îÄ‚îÄ create-context.ts (–¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

src/services/
  ‚îî‚îÄ‚îÄ time-entry-service.ts (–æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∞)

src/app/(dashboard)/admin/
  ‚îî‚îÄ‚îÄ page.tsx (–¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ä–∞–∑–¥–µ–ª—ã)
```

---

## üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –ø—Ä–∞–≤
**–†–µ—à–µ–Ω–∏–µ**: `src/lib/access-control/permissions.ts`
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ–ª–µ–π (`UserRole`)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∞–≤ (`Permission`)
- –ú–∞–ø–ø–∏–Ω–≥ —Ä–æ–ª–∏ ‚Üí –ø—Ä–∞–≤–∞ (`ROLE_PERMISSIONS`)
- –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ (`getPermissionsForRoles`, `hasPermission`)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∞
- ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (TypeScript)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### Repository Pattern –¥–ª—è –ë–î
**–†–µ—à–µ–Ω–∏–µ**: `DatabaseProvider` interface —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π `PostgresDatabaseProvider`
- –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ë–î
- –ú–µ—Ç–æ–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ (employees, projects, tasks, timeEntries)
- `_rawQuery` –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (mock provider)
- ‚úÖ –õ–µ–≥–∫–æ —Å–º–µ–Ω–∏—Ç—å –ë–î (–ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π provider)
- ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º

### Soft Delete –≤–º–µ—Å—Ç–æ Hard Delete
**–†–µ—à–µ–Ω–∏–µ**: `is_active = false` –≤–º–µ—Å—Ç–æ `DELETE FROM`
- –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏: is_active
- –†–æ–ª–∏: is_active

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –∞—É–¥–∏—Ç–∞
- ‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (foreign keys)
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ GDPR (–¥–ª—è –±—É–¥—É—â–µ–≥–æ)

---

## üîÆ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –±—É–¥—É—â–µ–µ

### 1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–ª—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –Ω–µ—Ç –ø—Ä–∞–≤ `time_entries:approve` –∏ `time_entries:reject` –≤ `permissions.ts`

–†–µ—à–µ–Ω–∏–µ:
```typescript
export type Permission =
  // ... existing permissions
  | 'time_entries:approve'
  | 'time_entries:reject'
```

### 2. –î–æ–±–∞–≤–∏—Ç—å —Å–º–µ–Ω—É –ø–∞—Ä–æ–ª—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `create-auth-for-employees.js` –∏–º–µ—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å

–†–µ—à–µ–Ω–∏–µ:
- API endpoint `/api/auth/change-password`
- UI —Ñ–æ—Ä–º–∞ –¥–ª—è —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ

### 3. –î–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏—Ç (Activity Log)
–¢–∞–±–ª–∏—Ü–∞ —É–∂–µ –µ—Å—Ç—å –≤ —Å—Ö–µ–º–µ: `activity_log`

–†–µ—à–µ–Ω–∏–µ:
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (CREATE, UPDATE, DELETE)
- –•—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∏ –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (JSONB)
- UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 4. –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç: `revenue_manual`, `salary_register`

–†–µ—à–µ–Ω–∏–µ:
- –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —ç—Ç–∏—Ö —Ç–∞–±–ª–∏—Ü
- –î–æ–±–∞–≤–∏—Ç—å CRUD API endpoints
- –î–æ–±–∞–≤–∏—Ç—å UI –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

### 5. –î–æ–±–∞–≤–∏—Ç—å batch operations
–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞: —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏

–†–µ—à–µ–Ω–∏–µ:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `batch_approvals` (—É–∂–µ –µ—Å—Ç—å –≤ —Å—Ö–µ–º–µ)
- API endpoint `/api/time-entries/batch-approve`
- UI –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π –∏ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –∫–∞–∂–¥–æ–º API endpoint —á–µ—Ä–µ–∑ `ctx.access.require()`
- ‚úÖ –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è
- ‚úÖ –ù–µ–ª—å–∑—è –æ—Ç–æ–∑–≤–∞—Ç—å admin —Ä–æ–ª—å —É —Å–∞–º–æ–≥–æ —Å–µ–±—è
- ‚úÖ Soft delete –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ Bcrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ Lucia Auth –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏

### TODO (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏):
- ‚è≥ –î–æ–±–∞–≤–∏—Ç—å RBAC (Role-Based Access Control) –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤
- ‚è≥ –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è API
- ‚è≥ –î–æ–±–∞–≤–∏—Ç—å CSRF protection
- ‚è≥ –î–æ–±–∞–≤–∏—Ç—å 2FA (Two-Factor Authentication) –¥–ª—è admin
- ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏—Ç –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

1. **TIME_ENTRIES_DATA_INTEGRITY_MODEL.md**:
   - –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö —Ç–∞–π–º—à–∏—Ç–∞
   - Foreign keys –∏ constraints
   - –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –∏ workflow
   - –ò–Ω–¥–µ–∫—Å—ã –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã

2. **ADMIN_PANEL_USER_GUIDE.md**:
   - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
   - API endpoints
   - Troubleshooting

3. **ARCHITECT_REPORT_2025_10_15.md** (—ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç):
   - –°–≤–æ–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç
   - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –±—É–¥—É—â–µ–µ

---

## üéâ –ò—Ç–æ–≥–∏

### –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∞–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (7 API + 2 UI)
- ‚úÖ –ù–∞–ø–∏—Å–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (8,000+ —Å–ª–æ–≤)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã –Ω–∞ Railway
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î –≤ –æ—Ç–ª–∏—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏

### –í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã: 15 –º–∏–Ω—É—Ç
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è: 30 –º–∏–Ω—É—Ç
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è API: 45 –º–∏–Ω—É—Ç
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è UI: 60 –º–∏–Ω—É—Ç
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: 45 –º–∏–Ω—É—Ç
- –°–∫—Ä–∏–ø—Ç—ã –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 30 –º–∏–Ω—É—Ç

**–ò—Ç–æ–≥–æ**: ~3.5 —á–∞—Å–∞ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:
- ‚úÖ TypeScript —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Ö–æ–¥–µ
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ best practices

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä**: AI Senior Architect  
**–î–∞—Ç–∞ –æ—Ç—á—ë—Ç–∞**: 2025-10-15  
**–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã**: Stage 2 (Post-MVP)

---

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞**: ‚úÖ Production Ready –¥–ª—è Stage 2

**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø**: Stage 3 (Advanced Features):
- –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1–°
- –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

